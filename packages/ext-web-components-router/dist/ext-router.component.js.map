{"version":3,"sources":["../lib/ext-router.component.js"],"names":["EwcBaseComponent","ExtRouterComponent","getAttribute","hidden","setAttribute","attrs","push","router","Router","window","routes","createProps","props","div","document","createElement","style","width","height","padding","display","backgroundSize","borderWidth","backgroundColor","backgroundImage","el","Ext","get","listeners","setEvent","xtype","ewc","element","attributeChangedCallback","attr","oldVal","newVal","route","getElementById","addEventListener","slice","event","eval","onReady","customElements","define","getRoutes","items","_routes","_getRoutes","forEach","item","leaf","hasOwnProperty","hash","text","replace","hashlower","toLowerCase","children","undefined","Route","component","defaultRoute","e","console","error","isActiveRoute","hashedPath","init","scope","hasChanged","location","length","currentHash","currentHashLower","currentComponent","i","substr","dir","rootElem","componentHtml","code","_code","innerHTML"],"mappings":"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","sourcesContent":["//import { base } from \"./base\";\nimport EwcBaseComponent from './ewc-base.component'\n\nexport class ExtRouterComponent extends EwcBaseComponent {\n    //prettier-ignore\n    get hidden() {return this.getAttribute(\"hidden\");}\n    set hidden(hidden) {\n        this.setAttribute(\"hidden\", hidden);\n    }\n\n    static get observedAttributes() {\n        var attrs = [];\n        attrs.push(\"hidden\");\n        attrs.push(\"onready\");\n        return attrs;\n    }\n\n    constructor() {\n        super();\n        this.router = new Router(window.routes);\n    }\n\n    createProps() {\n        this.props = {};\n        var div = document.createElement(\"DIV\");\n        div.setAttribute(\"id\", \"route\");\n        div.style.width = \"100%\";\n        div.style.height = \"100%\";\n        div.style.padding = this.padding;\n        div.style.display = \"none\";\n        //mjg should not be hard coded\n        div.style.backgroundSize = \"20px 20px\";\n        //div.style.overflow='scroll';\n        div.style.borderWidth = \"0px\";\n        div.style.backgroundColor = \"#e8e8e8\";\n        div.style.backgroundImage =\n            \"linear-gradient( 0deg, #f5f5f5 1.1px, transparent 0),\" +\n            \"linear-gradient(90deg, #f5f5f5 1.1px, transparent 0)\";\n        var el = Ext.get(div);\n        this.props[\"hidden\"] = this[\"hidden\"];\n        this.props.listeners = {};\n        this.setEvent(\"onready\", this.props, this);\n        this.props.xtype = \"widget\";\n        this.props.ewc = \"router\";\n        this.props.element = el;\n    }\n\n    attributeChangedCallback(attr, oldVal, newVal) {\n        var route = document.getElementById(\"route\");\n        if (route != null) {\n            if (attr == \"hidden\") {\n                if (newVal == \"true\") {\n                    route.style.display = \"none\";\n                } else {\n                    route.style.display = \"block\";\n                }\n            }\n        } else {\n            //console.log('route null: ' + attr + ' - ' + newVal)\n        }\n\n        if (attr == \"onready\") {\n            if (newVal) {\n                //mjg check if this event exists for this component\n                this.addEventListener(attr.slice(2), function(event) {\n                    eval(newVal + \"(event)\");\n                });\n            } else {\n                //delete this[attr];\n                //this.removeEventListener(attr.slice(2), this);\n            }\n        }\n    }\n}\n(function() {\n    Ext.onReady(function() {\n        window.customElements.define(\"ext-router\", ExtRouterComponent);\n    });\n})();\n\nexport function getRoutes(items) {\n    //mjg clean this up\n    window._routes = [];\n    var routes = _getRoutes(items);\n    window._routes = [];\n    return routes;\n}\n\nfunction _getRoutes(items) {\n    items.forEach(function(item) {\n        item.leaf = !item.hasOwnProperty(\"children\");\n        item.hash = item.text.replace(/\\s/g, \"\");\n        item.hashlower = item.hash.toLowerCase();\n        if (item.children == undefined) {\n            window._routes.push(\n                new Route(\n                    item.hash,\n                    item.hashlower,\n                    item.component,\n                    item.default\n                )\n            );\n        } else {\n            _getRoutes(item.children);\n        }\n    });\n    return window._routes;\n}\n\nexport class Route {\n    constructor(hash, hashlower, component, defaultRoute) {\n        try {\n            if (!hash) {\n                throw \"error: hash param is required\";\n            }\n        } catch (e) {\n            console.error(e);\n        }\n        this.hash = hash;\n        this.hashlower = hashlower;\n        this.component = component;\n        if (defaultRoute != undefined) {\n            this.default = defaultRoute;\n        }\n    }\n\n    isActiveRoute(hashedPath) {\n        return hashedPath.replace(\"#\", \"\") === this.hash;\n    }\n}\n\nexport class Router {\n    constructor(routes) {\n        window.router = this;\n        try {\n            if (!routes) {\n                throw \"error: routes param is mandatory\";\n            }\n            this.routes = routes;\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    init() {\n        var routes = this.routes;\n        (function(scope, routes) {\n            window.addEventListener(\"hashchange\", function(e) {\n                scope.hasChanged(scope, routes);\n            });\n        })(this, routes);\n        this.hasChanged(this, routes);\n    }\n\n    hasChanged(scope, routes) {\n        if (window.location.hash.length > 0) {\n            var currentHash = \"\";\n            var currentHashLower = \"\";\n            var currentComponent = null;\n            for (var i = 0, length = routes.length; i < length; i++) {\n                var route = routes[i];\n                if (route.isActiveRoute(window.location.hash.substr(1))) {\n                    console.dir(route)\n                    \n                    currentHash = route.hash;\n                    currentHashLower = route.hashlower;\n                    currentComponent = route.component;\n                }\n            }\n            scope.rootElem = document.getElementById(\"route\");\n            scope.rootElem.style.display = \"block\";\n            window[currentHashLower] = new currentComponent();\n            var componentHtml = currentHash + \"Component.html\";\n            var code = window._code[currentHashLower][componentHtml];\n            scope.rootElem.innerHTML = code;\n        } else {\n            var currentHash = \"\";\n            var currentHashLower = \"\";\n            var currentComponent = null;\n            for (var i = 0, length = routes.length; i < length; i++) {\n                var route = routes[i];\n                if (route.default == true) {\n                    currentHash = route.hash;\n                    currentHashLower = route.hashlower;\n                    currentComponent = route.component;\n                }\n            }\n            if (currentHash == \"\") {\n                //console.log('no default route specified')\n            } else {\n                scope.rootElem.style.display = \"block\";\n                window[currentHashLower] = new currentComponent();\n                var componentHtml = currentHash + \"Component.html\";\n                scope.rootElem.innerHTML =\n                    window._code[currentHashLower][componentHtml];\n            }\n        }\n    }\n}\n"],"file":"ext-router.component.js"}